var e;import{J as t}from"./vendor.4b080bc7.js";const n=(e,t)=>{const n=document.querySelector(e),a=null==n?void 0:n.value;if(!a)return null;try{return t(JSON.parse(a))}catch(r){return null}},a=(e,t="capsule_184x69.jpg")=>fetch(`https://cdn.akamai.steamstatic.com/steam/apps/${e}/${t}`).then((e=>e.blob())).then((e=>{const t=new FileReader;return new Promise((n=>{t.addEventListener("loadend",(()=>{n(t.result)})),t.readAsDataURL(e)}))})),r=()=>{const e=n("#games",(e=>e)),r=n("#sharedconfig",(e=>{var t,n,a,r;return null==(r=null==(a=null==(n=null==(t=null==e?void 0:e.UserRoamingConfigStore)?void 0:t.Software)?void 0:n.Valve)?void 0:a.Steam)?void 0:r.Apps}));if(!r)return void alert("Something wrong happened with sharedconfig");if(!e)return void alert("Something wrong happened with game data from steam profile page");const o=(e=>{const t=new Map;return Object.entries(e).forEach((([e,{tags:n}])=>{Object.values(n||{}).forEach((n=>{const a=t.get(n)||[];a.push(e),t.set(n,a)}))})),t})(r),l=document.querySelector("#category-select"),{addOption:c}=((e,t)=>{e.innerHTML="";const n=(t,n)=>{const a=document.createElement("option");a.value=t,a.label=n,e.appendChild(a)};return n("",t),{addOption:n}})(l,"Choose a category...");[...o.entries()].forEach((([e,{length:t}])=>{c(e,`${e} - ${t} items`)})),l.addEventListener("change",(e=>{e.currentTarget.value&&i.removeAttribute("disabled")}));const i=document.querySelector("#generate");i.addEventListener("click",(()=>{const n=l.value;(async e=>{const n=e.map((async({appid:e,name:t})=>{try{return{name:t,dataUrl:await a(e)}}catch(n){return console.log(`Failed to load image for ${t}`),null}})),r=(await Promise.all(n)).filter(Boolean),o=new t;return r.forEach((({name:e,dataUrl:t})=>{o.file(`${e}.jpg`,t.replace(/^data:image\/jpeg;base64,/,""),{base64:!0})})),await o.generateAsync({type:"blob"})})(((e,t,n)=>{const a=e.get(t)||[];return a.length?n.filter((({appid:e})=>a.includes(`${e}`))):[]})(o,n,e)).then((e=>{((e,t)=>{const n=document.createElement("a"),a=URL.createObjectURL(e);n.href=a,n.download=t,document.body.appendChild(n),n.click(),setTimeout((function(){document.body.removeChild(n),window.URL.revokeObjectURL(a)}),0)})(e,`${n}.zip`)}))}))};null==(e=document.querySelector("#load"))||e.addEventListener("click",(()=>{r()}));
